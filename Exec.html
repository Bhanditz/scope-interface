<!doctype html>
<title>Exec.2.1</title>
<link rel="icon" href="./style/favicon.ico">
<link rel="stylesheet" href="./style/style.css">
<script src="./script/script.js"></script>
<h1>Exec<span class="service-version">2.1</spnan></h1>
<div class="sidepanel">
<p class="back"><a href="./index.html">back</a></p>
<h3>Commands</h3>
<ul class="commands">
<li><a href="#Exec">Exec</a></li>
<li><a href="#GetActionInfoList">GetActionInfoList</a></li>
<li><a href="#SendMouseAction">SendMouseAction</a></li>
<li><a href="#SetupScreenWatcher">SetupScreenWatcher</a></li>

</ul>
<h3>Events</h3>
<ul class="events">

</ul>
<div title="Hint: hold shift to unfold all sub messages" class="setting">
 <label><input type="checkbox" class="default-collapse"> collapse all by default</label>
 </div>
</div>
<div class="main-view">
<div class="doc">
  <p>The Opera Exec protocol can be used to control an Opera instance from the outside, and various operations can be initiated. This functionality is mainly useful for QA testing. </p>
  <h2>Examples </h2>
  <p>The following example will do a spatial navigation down: </p>
  <p>.. code-block:: javascript </p>Exec([ [ ["_keydown","shift"], ["_keydown","down"], ["_keyup","down"], ["_keyup","shift"] ] ]) 
  <p>The following will type the text "Hello": </p>
  <p>.. code-block:: javascript </p>Exec([ [ ["_type","Hello"] ] ]) 
  <p>Take note that shift-modifier key-presses are neither generated nor taken into account when processing the letters of the <code>_type</code> operation. This means that no shift key will be pressed around the <span class="domain-specific">"H"</span> in <span class="domain-specific">"Hello"</span> above, and the text typed would still be <span class="domain-specific">"Hello"</span> if the shift key was pressed (with a <code>_keydown</code> operation) before the <code>_type</code> operation. </p>
  <p>The following will trigger an Action of "Page down": </p>
  <p>.. code-block:: javascript </p>Exec([ [ ["Page Down"] ] ]) 
  <h2>Error handling </h2>
  <p>There are currently no error messages or other reports of a failed operation.  Incorrect syntax, unknown keys, or other invalid input will be silently dropped. </p></div><h2 id="Exec"><a href="#Exec">Exec</a></h2>
<div class="doc">
  <p>Executes a series of actions in the opera host, each action consists of a name identifying the action and optionally a value for the action. The value depends on the type of action. </p></div><pre class="code-line" id="Exec.ActionList"><a href="#Exec.ActionList"><span class="keyword">command</span> <span class="command-name">Exec</span>(<span class="message-name">ActionList</span>)</a></pre><div class="message">
<pre class="code-line">{</pre>
<ul><li class="field">
<pre class="code-line" id="Exec.ActionList.actionList"><span class="expander">&nbsp;</span><a href="#Exec.ActionList.actionList"><span class="qualifier">repeated</span> <span class="">Action</span> <span class="field-name">actionList</span><span class="proto-key"> = 1</span><span class="proto-key">;</span></a></pre><div class="message">
<pre class="code-line">{</pre>
<ul><li class="field">
<pre class="code-line" id="Exec.ActionList.Action.name"><a href="#Exec.ActionList.Action.name"><span class="qualifier">required</span> <span class="string">string</span> <span class="field-name">name</span><span class="proto-key"> = 1</span><span class="proto-key">;</span></a></pre><div class="doc">
  <p>The name of the action to execute. This is either a regular Opera action (e.g. "Page Down"), or a special exec-action. Both kinds can be found by calling <span class="domain-specific">GetActionInfoList</span>. The special cases are prefixed with underscore ("_"), and these require <span class="domain-specific">value</span> parameter to work, but always ignores <span class="domain-specific">windowID</span>. </p>
  <p>The special cases may include:     _keydown | _keyup:         The <span class="domain-specific">value</span> is either a key-name ("ctrl", "down", etc.)         or a single character ("a", "b", etc.)     _type:         Types the text present in <span class="domain-specific">value</span>         (a different approach is the "Insert" action) </p>
  <p>It is currently not possible to figure out which actions take parameters (<span class="domain-specific">value</span>), and which don't. Optimistically, we have made the <span class="domain-specific">Action</span> type extendable to include such information later. </p></div></li>
<li class="field">
<pre class="code-line" id="Exec.ActionList.Action.value"><a href="#Exec.ActionList.Action.value"><span class="qualifier">optional</span> <span class="string">string</span> <span class="field-name">value</span><span class="proto-key"> = 2</span><span class="proto-key">;</span></a></pre><div class="doc">
  <p>String parameter for extra string data to be sent with the action E.g. "opera.com" to the command "go" </p></div></li>
<li class="field">
<pre class="code-line" id="Exec.ActionList.Action.windowID"><a href="#Exec.ActionList.Action.windowID"><span class="qualifier">optional</span> <span class="number">uint32</span> <span class="field-name">windowID</span><span class="proto-key"> = 3</span><span class="proto-key">;</span></a></pre><div class="doc">
  <p>Window to send the action to, 0 for the currently active window </p>
  <p>WARNING: Please be sure you want this is you use it as you          might not actually know the correct window and then          the action will fail. 0 is best if you are unsure </p></div></li>
<li class="field">
<pre class="code-line" id="Exec.ActionList.Action.data"><a href="#Exec.ActionList.Action.data"><span class="qualifier">optional</span> <span class="number">int32</span> <span class="field-name">data</span><span class="proto-key"> = 4</span><span class="proto-key">;</span></a></pre><div class="doc">
  <p>Data parameter for extra integer data to be sent with the action </p>
  <p>In some actions the data parameter is interpreted as a pointer rather than an integer. In these cases the action will fail. </p></div></li>
<li class="field">
<pre class="code-line" id="Exec.ActionList.Action.stringParam"><a href="#Exec.ActionList.Action.stringParam"><span class="qualifier">optional</span> <span class="string">string</span> <span class="field-name">stringParam</span><span class="proto-key"> = 5</span><span class="proto-key">;</span></a></pre><div class="doc">
  <p>Extra string parameter for action, sent in addition to the 'value' parameter for actions that need two strings </p></div></li>
</ul>
<pre class="code-line">}</pre>
</div></li>
</ul>
<pre class="code-line">}</pre>
</div><pre class="code-line" id="Exec.Default"><a href="#Exec.Default"><span class="keyword">returns</span> (<span class="message-name">Default</span>)</a></pre><div class="message">
<pre class="code-line">{</pre>
<ul></ul>
<pre class="code-line">}</pre>
</div><pre class="code-line" id="Exec.key"><a href="#Exec.key"><span class="proto-key">= 1;</span></a></pre><h2 id="GetActionInfoList"><a href="#GetActionInfoList">GetActionInfoList</a></h2>
<div class="doc">
  <p>Request a list of valid actions. </p></div><pre class="code-line" id="GetActionInfoList.Default"><a href="#GetActionInfoList.Default"><span class="keyword">command</span> <span class="command-name">GetActionInfoList</span>(<span class="message-name">Default</span>)</a></pre><div class="message">
<pre class="code-line">{</pre>
<ul></ul>
<pre class="code-line">}</pre>
</div><pre class="code-line" id="GetActionInfoList.ActionInfoList"><a href="#GetActionInfoList.ActionInfoList"><span class="keyword">returns</span> (<span class="message-name">ActionInfoList</span>)</a></pre><div class="message">
<pre class="code-line">{</pre>
<ul><li class="message-doc">
<div class="doc">
  <p>List all valid <span class="domain-specific">Action</span> <span class="domain-specific">name</span>s </p></div></li>
<li class="field">
<pre class="code-line" id="GetActionInfoList.ActionInfoList.actionInfoList"><span class="expander">&nbsp;</span><a href="#GetActionInfoList.ActionInfoList.actionInfoList"><span class="qualifier">repeated</span> <span class="">ActionInfo</span> <span class="field-name">actionInfoList</span><span class="proto-key"> = 1</span><span class="proto-key">;</span></a></pre><div class="message">
<pre class="code-line">{</pre>
<ul><li class="message-doc">
<div class="doc">
  <p>Name of an action, to be used in the <span class="domain-specific">Action</span> message. </p></div></li>
<li class="field">
<pre class="code-line" id="GetActionInfoList.ActionInfoList.ActionInfo.name"><a href="#GetActionInfoList.ActionInfoList.ActionInfo.name"><span class="qualifier">required</span> <span class="string">string</span> <span class="field-name">name</span><span class="proto-key"> = 1</span><span class="proto-key">;</span></a></pre></li>
</ul>
<pre class="code-line">}</pre>
</div></li>
</ul>
<pre class="code-line">}</pre>
</div><pre class="code-line" id="GetActionInfoList.key"><a href="#GetActionInfoList.key"><span class="proto-key">= 2;</span></a></pre><h2 id="SendMouseAction"><a href="#SendMouseAction">SendMouseAction</a></h2>
<div class="doc">
  <p>Move mouse to the given position on the screen/window. Note that the mouse cursor is not moved visibly. </p>
  <p>The coordinates are relative to the upper left corner of the tab (not including chrome). </p></div><pre class="code-line" id="SendMouseAction.MouseAction"><a href="#SendMouseAction.MouseAction"><span class="keyword">command</span> <span class="command-name">SendMouseAction</span>(<span class="message-name">MouseAction</span>)</a></pre><div class="message">
<pre class="code-line">{</pre>
<ul><li class="field">
<pre class="code-line" id="SendMouseAction.MouseAction.windowID"><a href="#SendMouseAction.MouseAction.windowID"><span class="qualifier">required</span> <span class="number">uint32</span> <span class="field-name">windowID</span><span class="proto-key"> = 1</span><span class="proto-key">;</span></a></pre></li>
<li class="field">
<pre class="code-line" id="SendMouseAction.MouseAction.x"><a href="#SendMouseAction.MouseAction.x"><span class="qualifier">required</span> <span class="number">int32</span> <span class="field-name">x</span><span class="proto-key"> = 2</span><span class="proto-key">;</span></a></pre></li>
<li class="field">
<pre class="code-line" id="SendMouseAction.MouseAction.y"><a href="#SendMouseAction.MouseAction.y"><span class="qualifier">required</span> <span class="number">int32</span> <span class="field-name">y</span><span class="proto-key"> = 3</span><span class="proto-key">;</span></a></pre></li>
<li class="field">
<pre class="code-line" id="SendMouseAction.MouseAction.buttonAction"><a href="#SendMouseAction.MouseAction.buttonAction"><span class="qualifier">required</span> <span class="number">uint32</span> <span class="field-name">buttonAction</span><span class="proto-key"> = 4</span><span class="proto-key">;</span></a></pre><div class="doc">
  <p><span class="domain-specific">buttonAction</span> specifies the buttons to press or release It is specifies as the sum of button actions:       1 - Button 1 down       2 - Button 1 up </p>4 - Button 2 down 8 - Button 2 up 16 - Button 3 down 32 - Button 3 up 
  <p>For example, to press button 1 and release button 2, the value is 9 (1+8) </p>
  <p>Buttons are clicked in the sequence listed above. Note that down actions are listed before up actions, thus allowing single-clicking with one command (e.g. using value 3) </p></div></li>
</ul>
<pre class="code-line">}</pre>
</div><pre class="code-line" id="SendMouseAction.Default"><a href="#SendMouseAction.Default"><span class="keyword">returns</span> (<span class="message-name">Default</span>)</a></pre><div class="message">
<pre class="code-line">{</pre>
<ul></ul>
<pre class="code-line">}</pre>
</div><pre class="code-line" id="SendMouseAction.key"><a href="#SendMouseAction.key"><span class="proto-key">= 5;</span></a></pre><h2 id="SetupScreenWatcher"><a href="#SetupScreenWatcher">SetupScreenWatcher</a></h2>
<pre class="code-line" id="SetupScreenWatcher.ScreenWatcher"><a href="#SetupScreenWatcher.ScreenWatcher"><span class="keyword">command</span> <span class="command-name">SetupScreenWatcher</span>(<span class="message-name">ScreenWatcher</span>)</a></pre><div class="message">
<pre class="code-line">{</pre>
<ul><li class="field">
<pre class="code-line" id="SetupScreenWatcher.ScreenWatcher.timeOut"><a href="#SetupScreenWatcher.ScreenWatcher.timeOut"><span class="qualifier">required</span> <span class="number">uint32</span> <span class="field-name">timeOut</span><span class="proto-key"> = 1</span> [default = 10000]<span class="proto-key">;</span></a></pre><div class="doc">
  <p>Number of milliseconds to wait before capturing the screen area. </p>
  <p>The default is 10 seconds. </p></div></li>
<li class="field">
<pre class="code-line" id="SetupScreenWatcher.ScreenWatcher.area"><span class="expander">&nbsp;</span><a href="#SetupScreenWatcher.ScreenWatcher.area"><span class="qualifier">required</span> <span class="">Area</span> <span class="field-name">area</span><span class="proto-key"> = 2</span><span class="proto-key">;</span></a></pre><div class="doc">
  <p>Define an area on the page, relative to the page (not viewport). </p>
  <p>The default area is {x=0, y=0, w=200, h=100}. </p></div><div class="message">
<pre class="code-line">{</pre>
<ul><li class="field">
<pre class="code-line" id="SetupScreenWatcher.ScreenWatcher.Area.x"><a href="#SetupScreenWatcher.ScreenWatcher.Area.x"><span class="qualifier">required</span> <span class="number">int32</span> <span class="field-name">x</span><span class="proto-key"> = 1</span><span class="proto-key">;</span></a></pre></li>
<li class="field">
<pre class="code-line" id="SetupScreenWatcher.ScreenWatcher.Area.y"><a href="#SetupScreenWatcher.ScreenWatcher.Area.y"><span class="qualifier">required</span> <span class="number">int32</span> <span class="field-name">y</span><span class="proto-key"> = 2</span><span class="proto-key">;</span></a></pre></li>
<li class="field">
<pre class="code-line" id="SetupScreenWatcher.ScreenWatcher.Area.w"><a href="#SetupScreenWatcher.ScreenWatcher.Area.w"><span class="qualifier">required</span> <span class="number">int32</span> <span class="field-name">w</span><span class="proto-key"> = 3</span><span class="proto-key">;</span></a></pre></li>
<li class="field">
<pre class="code-line" id="SetupScreenWatcher.ScreenWatcher.Area.h"><a href="#SetupScreenWatcher.ScreenWatcher.Area.h"><span class="qualifier">required</span> <span class="number">int32</span> <span class="field-name">h</span><span class="proto-key"> = 4</span><span class="proto-key">;</span></a></pre></li>
</ul>
<pre class="code-line">}</pre>
</div></li>
<li class="field">
<pre class="code-line" id="SetupScreenWatcher.ScreenWatcher.md5List"><a href="#SetupScreenWatcher.ScreenWatcher.md5List"><span class="qualifier">repeated</span> <span class="string">string</span> <span class="field-name">md5List</span><span class="proto-key"> = 3</span><span class="proto-key">;</span></a></pre><div class="doc">
  <p><code>MD5</code> sum of an image, in hexadecimal. </p></div></li>
<li class="field">
<pre class="code-line" id="SetupScreenWatcher.ScreenWatcher.windowID"><a href="#SetupScreenWatcher.ScreenWatcher.windowID"><span class="qualifier">optional</span> <span class="number">uint32</span> <span class="field-name">windowID</span><span class="proto-key"> = 4</span> [default = 0]<span class="proto-key">;</span></a></pre><div class="doc">
  <p>The ID of the window to watch, the default (or 0) is to watch the current window </p></div></li>
<li class="field">
<pre class="code-line" id="SetupScreenWatcher.ScreenWatcher.colorSpecList"><span class="expander">&nbsp;</span><a href="#SetupScreenWatcher.ScreenWatcher.colorSpecList"><span class="qualifier">repeated</span> <span class="">ColorSpec</span> <span class="field-name">colorSpecList</span><span class="proto-key"> = 5</span><span class="proto-key">;</span></a></pre><div class="message">
<pre class="code-line">{</pre>
<ul><li class="message-doc">
<div class="doc">
  <p>Specifies a new color specification. The <span class="domain-specific">id</span> is used when reporting back the results. You can have overlapping color specifications. Note: There can be a maximum of 16 color specifications! </p>
  <p>Color values ranges from 0 (no color) to 255 (maximal saturation), other values are not allowed. Default (meaning field missing) is 0 for any low fields and 255 for any high fields. </p></div></li>
<li class="field">
<pre class="code-line" id="SetupScreenWatcher.ScreenWatcher.ColorSpec.id"><a href="#SetupScreenWatcher.ScreenWatcher.ColorSpec.id"><span class="qualifier">required</span> <span class="number">uint32</span> <span class="field-name">id</span><span class="proto-key"> = 1</span><span class="proto-key">;</span></a></pre></li>
<li class="field">
<pre class="code-line" id="SetupScreenWatcher.ScreenWatcher.ColorSpec.redLow"><a href="#SetupScreenWatcher.ScreenWatcher.ColorSpec.redLow"><span class="qualifier">optional</span> <span class="number">uint32</span> <span class="field-name">redLow</span><span class="proto-key"> = 2</span> [default = 0]<span class="proto-key">;</span></a></pre></li>
<li class="field">
<pre class="code-line" id="SetupScreenWatcher.ScreenWatcher.ColorSpec.redHigh"><a href="#SetupScreenWatcher.ScreenWatcher.ColorSpec.redHigh"><span class="qualifier">optional</span> <span class="number">uint32</span> <span class="field-name">redHigh</span><span class="proto-key"> = 3</span> [default = 255]<span class="proto-key">;</span></a></pre></li>
<li class="field">
<pre class="code-line" id="SetupScreenWatcher.ScreenWatcher.ColorSpec.greenLow"><a href="#SetupScreenWatcher.ScreenWatcher.ColorSpec.greenLow"><span class="qualifier">optional</span> <span class="number">uint32</span> <span class="field-name">greenLow</span><span class="proto-key"> = 4</span> [default = 0]<span class="proto-key">;</span></a></pre></li>
<li class="field">
<pre class="code-line" id="SetupScreenWatcher.ScreenWatcher.ColorSpec.greenHigh"><a href="#SetupScreenWatcher.ScreenWatcher.ColorSpec.greenHigh"><span class="qualifier">optional</span> <span class="number">uint32</span> <span class="field-name">greenHigh</span><span class="proto-key"> = 5</span> [default = 255]<span class="proto-key">;</span></a></pre></li>
<li class="field">
<pre class="code-line" id="SetupScreenWatcher.ScreenWatcher.ColorSpec.blueLow"><a href="#SetupScreenWatcher.ScreenWatcher.ColorSpec.blueLow"><span class="qualifier">optional</span> <span class="number">uint32</span> <span class="field-name">blueLow</span><span class="proto-key"> = 6</span> [default = 0]<span class="proto-key">;</span></a></pre></li>
<li class="field">
<pre class="code-line" id="SetupScreenWatcher.ScreenWatcher.ColorSpec.blueHigh"><a href="#SetupScreenWatcher.ScreenWatcher.ColorSpec.blueHigh"><span class="qualifier">optional</span> <span class="number">uint32</span> <span class="field-name">blueHigh</span><span class="proto-key"> = 7</span> [default = 255]<span class="proto-key">;</span></a></pre></li>
</ul>
<pre class="code-line">}</pre>
</div></li>
<li class="field">
<pre class="code-line" id="SetupScreenWatcher.ScreenWatcher.includeImage"><a href="#SetupScreenWatcher.ScreenWatcher.includeImage"><span class="qualifier">optional</span> <span class="boolean">bool</span> <span class="field-name">includeImage</span><span class="proto-key"> = 6</span> [default = true]<span class="proto-key">;</span></a></pre><div class="doc">
  <p>If true then the image data will be sent in the response <span class="domain-specific">WatcherResult.png</span>, otherwise the field will be omitted Can be used to reduce bandwith usage in applications where only hashes are needed. </p></div></li>
</ul>
<pre class="code-line">}</pre>
</div><pre class="code-line" id="SetupScreenWatcher.ScreenWatcherResult"><a href="#SetupScreenWatcher.ScreenWatcherResult"><span class="keyword">returns</span> (<span class="message-name">ScreenWatcherResult</span>)</a></pre><div class="message">
<pre class="code-line">{</pre>
<ul><li class="field">
<pre class="code-line" id="SetupScreenWatcher.ScreenWatcherResult.windowID"><a href="#SetupScreenWatcher.ScreenWatcherResult.windowID"><span class="qualifier">required</span> <span class="number">uint32</span> <span class="field-name">windowID</span><span class="proto-key"> = 1</span><span class="proto-key">;</span></a></pre><div class="doc">
  <p>The ID of the window that was triggered by a screen watch, or 0 if the screen watch failed or was cancelled </p></div></li>
<li class="field">
<pre class="code-line" id="SetupScreenWatcher.ScreenWatcherResult.md5"><a href="#SetupScreenWatcher.ScreenWatcherResult.md5"><span class="qualifier">required</span> <span class="string">string</span> <span class="field-name">md5</span><span class="proto-key"> = 2</span><span class="proto-key">;</span></a></pre><div class="doc">
  <p><code>MD5</code> sum of an image, in hexadecimal. </p></div></li>
<li class="field">
<pre class="code-line" id="SetupScreenWatcher.ScreenWatcherResult.png"><a href="#SetupScreenWatcher.ScreenWatcherResult.png"><span class="qualifier">optional</span> <span class="string">bytes</span> <span class="field-name">png</span><span class="proto-key"> = 3</span><span class="proto-key">;</span></a></pre></li>
<li class="field">
<pre class="code-line" id="SetupScreenWatcher.ScreenWatcherResult.colorMatchList"><span class="expander">&nbsp;</span><a href="#SetupScreenWatcher.ScreenWatcherResult.colorMatchList"><span class="qualifier">repeated</span> <span class="">ColorMatch</span> <span class="field-name">colorMatchList</span><span class="proto-key"> = 4</span><span class="proto-key">;</span></a></pre><div class="message">
<pre class="code-line">{</pre>
<ul><li class="field">
<pre class="code-line" id="SetupScreenWatcher.ScreenWatcherResult.ColorMatch.id"><a href="#SetupScreenWatcher.ScreenWatcherResult.ColorMatch.id"><span class="qualifier">required</span> <span class="number">uint32</span> <span class="field-name">id</span><span class="proto-key"> = 1</span><span class="proto-key">;</span></a></pre><div class="doc">
  <p>The <span class="domain-specific">ColorSpec.id</span> which matched a color </p></div></li>
<li class="field">
<pre class="code-line" id="SetupScreenWatcher.ScreenWatcherResult.ColorMatch.count"><a href="#SetupScreenWatcher.ScreenWatcherResult.ColorMatch.count"><span class="qualifier">required</span> <span class="number">uint32</span> <span class="field-name">count</span><span class="proto-key"> = 2</span><span class="proto-key">;</span></a></pre><div class="doc">
  <p>Number of pixels for the matching <span class="domain-specific">id</span> </p></div></li>
</ul>
<pre class="code-line">}</pre>
</div></li>
</ul>
<pre class="code-line">}</pre>
</div><pre class="code-line" id="SetupScreenWatcher.key"><a href="#SetupScreenWatcher.key"><span class="proto-key">= 3;</span></a></pre></div>
